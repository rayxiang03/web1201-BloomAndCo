<html>
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>B&Co. - Profile</title>
      <link rel="icon" href="./assets/images/favicon.svg" type="image/svg+xml" sizes="any">

      <link href="assets/css/style.css" rel="stylesheet" type="text/css" />
      <link href="assets/css/profile.css" rel="stylesheet" type="text/css" />

      <!-- Font Awesome ONLY -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>

      <style>
.header *{
    color: black;
}
.header{
    box-shadow: 0 7.8px 11px hsla(114, 24%, 69%, 0.15);
}
      </style>
      </head>

    <script>
        let session = localStorage.getItem('session_name')?localStorage.getItem('session_name'):'unknown'
        if(session ==='unknown'){
           alert('You are required to login to access Profile.');
           window.location.href="login.html";
        }

        function Logout(){
          localStorage.removeItem('session_name');
          localStorage.removeItem('session_email');
          localStorage.removeItem('session_dob');
          localStorage.removeItem('session_contactNumber');
          localStorage.removeItem('session_address');
          localStorage.removeItem('session_gender');
          alert('Successfully Logout!');
          window.location.href="login.html";
        }
    </script>

      <body>

        <header class="header" data_hdr>
            <div class="container">
    
                <!-- Only Available when the screen size is smaller ya-->
                <button class="nav_minimize" data_minimize>
                    <i class="fa fa-bars" id="threeLines" name="menu-outline"></i>
                    <i class="fa fa-times" id="tutup" name="close-outline"></i>
                </button>
                <a href="index.html" class="logo"><img src="assets/images/logo-ver2.svg" width="150px"></a>
                <!------------------------------------------------------->
    
                <nav class="NavigationBar" data_nav_bar>
                    <ul class="NavigationBar_List">
                        <li><a href="index.html" class="navbar_href" data_nav_href>Home</a></li>
                        <li><a href="shop.html" class="navbar_href" data_nav_href>Shop</a></li>
                        <li><a href="about.html" class="navbar_href" data_nav_href>About</a></li>
                        <li><a href="contact_us.html" class="navbar_href" data_nav_href>Contact</a></li>
                    </ul>
    
                    <a href="login.html" class="nav_login">LOG IN</a>
                </nav>
    
                <div class="rightHeader">
                  <div style="position: relative; display: inline-block;">
                    <form method="GET">
                      <input type="search" placeholder="Search Products..." id="search" style="padding: 8px; width: 150px; border: 1px solid #ccc; border-radius: 8px;">
                        <button style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%);" onclick="search()">
                          <i class="fa fa-search" style="font-size:16px; color: #3a4e1d;" aria-hidden="true"></i>
                        </button>
                    </form>
                  </div>
                
                    <button class="headerButton user">
                        <a href="login.html">
                            <i class="fa fa-user" style="font-size:20px"></i>
                        </a>
                    </button>
    
                    <button class="headerButton">
                      <a href="shopping_cart.html">
                        <i class="fa fa-shopping-cart" style="font-size:20px"></i>
                      </a>
                    </button>
                </div>
            </div>
        </header>  


    <div class="profile">
          <div class="profile_title">
              <h1>User Profile </h1>
              <button onclick="Logout();" class="logout">Logout</button>
          </div>
          <div class="profile_table">
              <table>
                  <tr>
                      <td><strong>Name:</strong></td>
                      <td><script>document.write(localStorage.getItem('session_name'));</script></td>
                  </tr>
                  <tr>
                      <td><strong>Email:</strong></td>
                      <td><script>document.write(localStorage.getItem('session_email'));</script></td>
                  </tr>
                  <tr>
                      <td><strong>Gender:</strong></td>
                      <td><script>document.write(localStorage.getItem('session_gender'));</script></td>
                  </tr>
                  <tr>
                      <td><strong>Date of Birth:</strong></td>
                      <td><script>document.write(localStorage.getItem('session_dob'));</script></td>
                  </tr>
                  <tr>
                      <td><strong>Contact Number:</strong></td>
                      <td><script>document.write(localStorage.getItem('session_contactNumber'));</script></td>
                  </tr>
                  <tr>
                      <td><strong>Address:</strong></td>
                      <td><script>document.write(localStorage.getItem('session_address'));</script></td>
                  </tr>
              </table>
          </div>

          <div class="profile_table">
            <h2>Contact History</h2>
            <table id="historyTable">
                <thead> 
                    <tr>
                        <th>Date</th>
                        <th>Message</th>
                        <th>Status</th>
                    </tr>
                </thead>
               
                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <footer style="background-image: url('./assets/images/footer.gif')">
        <div class="footer_box section">
            <div class="container">
                <div>
                    <a href="#" class="logo">Bloom&Co.</a>
                    <p class="footer-text" style="margin-block-end: 22px; color: rgba(71, 66, 66, 0.856);;">If you have any enquiry, please find us at <a href="mailto:support@bloom.com" style="color: slateblue; font-weight: bold;">support@bloom.com</a></p>
                    <ul>
                        <li class="contact">
                            <i class="fa fa-map-marker" style="font-size:26px; color: #505e3c;"></i>
                            <address style="color: rgba(71, 66, 66, 0.856);">
                                1, Jalan Puteri 1/1 Bandar Puteri 47100 Puchong Selangor.
                            </address>
                        </li>

                        <li class="contact">
                            <i class="fa fa-phone" style="font-size:26px; color: #505e3c;"></i>

                            <a href="tel:+6010010100" style="color: rgba(71, 66, 66, 0.856);">(+60)-10 010 0100</a>
                        </li>
                    </ul>
                </div>

                <ul>
                    <li><p class="footer_title">About</p></li>
                    <li style="text-align: justify; color: #193b44;">
                        Founded in 2023,
                        Bloom&Co. takes pride in curating the finest blooms
                        and greenery worldwide. <b>"Where every leaf tells a story, 
                        and every plant inspires a moment of natural beauty."</b>
                    </li>
                </ul>

                <ul style="color: #3b4232;">
                    <li><p class="footer_title">Menu</p></li>
                    <li><a href="contact_us.html" class="footer_href">Contact Us</a></li>
                    <li><a href="login.html" class="footer_href">Login</a></li>
                    <li><a href="register.html" class="footer_href">Register</a></li>
                    <li><a href="about.html" class="footer_href">About</a></li>
                    <li><a href="shop.html" class="footer_href">Shop</a></li>
                </ul>

            </div>
        </div>

        <div style="padding-block: 2px;">
            <div class="container">
                <p style="text-align: center;">&copy; 2023 Bloom&Co.  <i><sub style="color: rgb(36, 158, 189);">by RayXiang</sub></i></p>
                <p class="dates">Version: 20231201B | Created on: 20 November 2023 | Last Updated on: 10 December 2023 | Data Collection Date: 30 November 2023</p>
            </div>
        </div>
    </footer>

      </body>

</html>
      
<script src="./assets/javascripts/navigation.js" defer></script>

<script>
        function getHistory() {
            var storedData = localStorage.getItem('contact_forms');
            return storedData ? JSON.parse(storedData) : [];
        }

        function loadHistoryTable() {
            var tableBody = document.getElementById('historyTable').getElementsByTagName('tbody')[0];
            var historyData = getHistory();
            var email = localStorage.getItem('session_email');

            var found = 0;

            // Clear existing rows
            tableBody.innerHTML = '';

            if (historyData) {
                historyData.forEach(function (entry) {

            if (entry.email === email) {
                var row = tableBody.insertRow(tableBody.rows.length);
                var dateCell = row.insertCell(0);
                var messageCell = row.insertCell(1);
                var statusCell = row.insertCell(2);

                dateCell.textContent = entry.time;
                messageCell.textContent = entry.message;
                statusCell.textContent = entry.status;

                found = 1;
            }
        });
    }

    if(found == 0){
        var row = tableBody.insertRow(tableBody.rows.length);
        var noDataCell = row.insertCell(0);
        noDataCell.colSpan = 3; 
        noDataCell.textContent = "No contact history available.";
    }
}
    loadHistoryTable();
</script>